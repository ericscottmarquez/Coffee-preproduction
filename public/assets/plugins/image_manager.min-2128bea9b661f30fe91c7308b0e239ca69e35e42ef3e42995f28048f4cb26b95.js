/*!
 * froala_editor v2.8.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(a,t){return t===undefined&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(a)),e(t)}:e(window.jQuery)}(function(e){if(e.extend(e.FE.DEFAULTS,{imageManagerLoadURL:"https://i.froala.com/load-files",imageManagerLoadMethod:"get",imageManagerLoadParams:{},imageManagerPreloader:null,imageManagerDeleteURL:"",imageManagerDeleteMethod:"post",imageManagerDeleteParams:{},imageManagerPageSize:12,imageManagerScrollOffset:20,imageManagerToggleTags:!0}),e.FE.PLUGINS.imageManager=function(a){function t(){var a=e(window).outerWidth();return a<768?2:a<1200?3:4}function r(){L.empty();for(var e=0;e<E;e++)L.append('<div class="fr-list-column"></div>')}function i(){if(P<D.length&&(L.outerHeight()<=b.outerHeight()+a.opts.imageManagerScrollOffset||b.scrollTop()+a.opts.imageManagerScrollOffset>L.outerHeight()-b.outerHeight())){I++;for(var e=a.opts.imageManagerPageSize*(I-1);e<Math.min(D.length,a.opts.imageManagerPageSize*I);e++)n(D[e])}}function n(t){var r=new Image,n=e('<div class="fr-image-container fr-empty fr-image-'+x+++'" data-loading="'+a.language.translate("Loading")+'.." data-deleting="'+a.language.translate("Deleting")+'..">');l(!1),r.onload=function(){n.height(Math.floor(n.width()/r.width*r.height));var s=e("<img/>");if(t.thumb)s.attr("src",t.thumb);else{if(u(F,t),!t.url)return u(H,t),!1;s.attr("src",t.url)}if(t.url&&s.attr("data-url",t.url),t.tag)if(w.find(".fr-modal-more.fr-not-available").removeClass("fr-not-available"),w.find(".fr-modal-tags").show(),0<=t.tag.indexOf(",")){for(var d=t.tag.split(","),f=0;f<d.length;f++)d[f]=d[f].trim(),0===y.find('a[title="'+d[f]+'"]').length&&y.append('<a role="button" title="'+d[f]+'">'+d[f]+"</a>");s.attr("data-tag",d.join())}else 0===y.find('a[title="'+t.tag.trim()+'"]').length&&y.append('<a role="button" title="'+t.tag.trim()+'">'+t.tag.trim()+"</a>"),s.attr("data-tag",t.tag.trim());for(var m in t.name&&s.attr("alt",t.name),t)t.hasOwnProperty(m)&&"thumb"!=m&&"url"!=m&&"tag"!=m&&s.attr("data-"+m,t[m]);n.append(s).append(e(a.icon.create("imageManagerDelete")).addClass("fr-delete-img").attr("title",a.language.translate("Delete"))).append(e(a.icon.create("imageManagerInsert")).addClass("fr-insert-img").attr("title",a.language.translate("Insert"))),y.find(".fr-selected-tag").each(function(e,a){v(s,a.text)||n.hide()}),s.on("load",function(){n.removeClass("fr-empty"),n.height("auto"),P++,g(o(parseInt(s.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1)),l(!1),P%a.opts.imageManagerPageSize==0&&i()}),a.events.trigger("imageManager.imageLoaded",[s])},r.onerror=function(){P++,n.remove(),g(o(parseInt(n.attr("class").match(/fr-image-(\d+)/)[1],10)+1)),u(q,t),P%a.opts.imageManagerPageSize==0&&i()},r.src=t.thumb||t.url,s().append(n)}function s(){var a,t;return L.find(".fr-list-column").each(function(r,i){var n=e(i);0===r?(t=n.outerHeight(),a=n):n.outerHeight()<t&&(t=n.outerHeight(),a=n)}),a}function o(a){a===undefined&&(a=0);for(var t=[],r=x-1;a<=r;r--){var i=L.find(".fr-image-"+r);i.length&&(t.push(i),e('<div id="fr-image-hidden-container">').append(i),L.find(".fr-image-"+r).remove())}return t}function g(e){for(var a=e.length-1;0<=a;a--)s().append(e[a])}function l(e){if(e===undefined&&(e=!0),!M.is(":visible"))return!0;var n=t();if(n!=E){E=n;var s=o();r(),g(s)}a.modals.resize(T),e&&i()}function d(e){var a={},t=e.data();for(var r in t)t.hasOwnProperty(r)&&"url"!=r&&"tag"!=r&&(a[r]=t[r]);return a}function f(t){var r=e(t.currentTarget).siblings("img"),i=M.data("instance")||a,n=M.data("current-image");if(a.modals.hide(T),i.image.showProgressBar(),n)n.data("fr-old-src",n.attr("src")),n.trigger("click");else{i.events.focus(!0),i.selection.restore();var s=i.position.getBoundingRect(),o=s.left+s.width/2+e(a.doc).scrollLeft(),g=s.top+s.height+e(a.doc).scrollTop();i.popups.setContainer("image.insert",a.$sc),i.popups.show("image.insert",o,g)}i.image.insert(r.data("url"),!1,d(r),n)}function m(t){var r=e(t.currentTarget).siblings("img"),i=a.language.translate("Are you sure? Image will be deleted.");confirm(i)&&(a.opts.imageManagerDeleteURL?!1!==a.events.trigger("imageManager.beforeDeleteImage",[r])&&(r.parent().addClass("fr-image-deleting"),e.ajax({method:a.opts.imageManagerDeleteMethod,url:a.opts.imageManagerDeleteURL,data:e.extend(e.extend({src:r.attr("src")},d(r)),a.opts.imageManagerDeleteParams),crossDomain:a.opts.requestWithCORS,xhrFields:{withCredentials:a.opts.requestWithCredentials},headers:a.opts.requestHeaders}).done(function(t){a.events.trigger("imageManager.imageDeleted",[t]);var i=o(parseInt(r.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1);r.parent().remove(),g(i),M.find("#fr-modal-tags > a").each(function(){0===M.find('#fr-image-list [data-tag*="'+e(this).text()+'"]').length&&e(this).removeClass("fr-selected-tag").hide()}),h(),l(!0)}).fail(function(e){u(j,e.response||e.responseText)})):u(k))}function u(t,r){10<=t&&t<20?C.hide():20<=t&&t<30&&e(".fr-image-deleting").removeClass("fr-image-deleting"),a.events.trigger("imageManager.error",[{code:t,message:O[t]},r])}function c(){var e=w.find(".fr-modal-head-line").outerHeight(),a=y.outerHeight();w.toggleClass("fr-show-tags"),w.hasClass("fr-show-tags")?(w.css("height",e+a),y.find("a").css("opacity",1)):(w.css("height",e),y.find("a").css("opacity",0))}function h(){var a=y.find(".fr-selected-tag");0<a.length?(L.find("img").parent().show(),a.each(function(a,t){L.find("img").each(function(a,r){var i=e(r);v(i,t.text)||i.parent().hide()})})):L.find("img").parent().show(),g(o()),i()}function p(t){t.preventDefault();var r=e(t.currentTarget);r.toggleClass("fr-selected-tag"),a.opts.imageManagerToggleTags&&r.siblings("a").removeClass("fr-selected-tag"),h()}function v(e,a){for(var t=(e.attr("data-tag")||"").split(","),r=0;r<t.length;r++)if(t[r]==a)return!0;return!1}var M,w,b,C,L,y,D,I,P,x,E,T="image_manager",q=10,S=11,R=12,U=13,F=14,H=15,j=21,k=22,O={};return O[q]="Image cannot be loaded from the passed link.",O[S]="Error during load images request.",O[R]="Missing imageManagerLoadURL option.",O[U]="Parsing load response failed.",O[F]="Missing image thumb.",O[H]="Missing image URL.",O[j]="Error during delete image request.",O[k]="Missing imageManagerDeleteURL option.",{require:["image"],_init:function(){if(!a.$wp&&"IMG"!=a.el.tagName)return!1},show:function(){if(!M){var n,s='<div class="fr-modal-head-line"><i class="fa fa-bars fr-modal-more fr-not-available" id="fr-modal-more-'+a.sid+'" title="'+a.language.translate("Tags")+'"></i><h4 data-text="true">'+a.language.translate("Manage Images")+"</h4></div>";s+='<div class="fr-modal-tags" id="fr-modal-tags"></div>',n=a.opts.imageManagerPreloader?'<img class="fr-preloader" id="fr-preloader" alt="'+a.language.translate("Loading")+'.." src="'+a.opts.imageManagerPreloader+'" style="display: none;">':'<span class="fr-preloader" id="fr-preloader" style="display: none;">'+a.language.translate("Loading")+"</span>",n+='<div class="fr-image-list" id="fr-image-list"></div>';var o=a.modals.create(T,s,n);M=o.$modal,w=o.$head,b=o.$body}M.data("current-image",a.image.get()),a.modals.show(T),C||(C=M.find("#fr-preloader"),L=M.find("#fr-image-list"),y=M.find("#fr-modal-tags"),E=t(),r(),w.css("height",w.find(".fr-modal-head-line").outerHeight()),a.events.$on(e(a.o_win),"resize",function(){l(!!D)}),a.helpers.isMobile()&&(a.events.bindClick(L,"div.fr-image-container",function(a){M.find(".fr-mobile-selected").removeClass("fr-mobile-selected"),e(a.currentTarget).addClass("fr-mobile-selected")}),M.on(a._mousedown,function(){M.find(".fr-mobile-selected").removeClass("fr-mobile-selected")})),a.events.bindClick(L,".fr-insert-img",f),a.events.bindClick(L,".fr-delete-img",m),M.on(a._mousedown+" "+a._mouseup,function(e){e.stopPropagation()}),M.on(a._mousedown,"*",function(){a.events.disableBlur()}),b.on("scroll",i),a.events.bindClick(M,"i#fr-modal-more-"+a.sid,c),a.events.bindClick(y,"a",p)),C.show(),L.find(".fr-list-column").empty(),a.opts.imageManagerLoadURL?e.ajax({url:a.opts.imageManagerLoadURL,method:a.opts.imageManagerLoadMethod,data:a.opts.imageManagerLoadParams,dataType:"json",crossDomain:a.opts.requestWithCORS,xhrFields:{withCredentials:a.opts.requestWithCredentials},headers:a.opts.requestHeaders}).done(function(e,t,r){a.events.trigger("imageManager.imagesLoaded",[e]),function(e,a){try{L.find(".fr-list-column").empty(),x=P=I=0,D=e,i()}catch(r){u(U,a)}}(e,r.response),C.hide()}).fail(function(){var e=this.xhr();u(S,e.response||e.responseText)}):u(R)},hide:function(){a.modals.hide(T)}}},!e.FE.PLUGINS.image)throw new Error("Image manager plugin requires image plugin.");e.FE.DEFAULTS.imageInsertButtons.push("imageManager"),e.FE.RegisterCommand("imageManager",{title:"Browse",undo:!1,focus:!1,modal:!0,callback:function(){this.imageManager.show()},plugin:"imageManager"}),e.FE.DefineIcon("imageManager",{NAME:"folder"}),e.FE.DefineIcon("imageManagerInsert",{NAME:"plus"}),e.FE.DefineIcon("imageManagerDelete",{NAME:"trash"})});