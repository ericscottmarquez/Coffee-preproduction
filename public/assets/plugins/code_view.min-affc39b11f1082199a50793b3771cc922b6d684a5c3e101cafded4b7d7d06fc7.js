/*!
 * froala_editor v2.8.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,n){return n===undefined&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(n)}:e(window.jQuery)}(function(e){e.extend(e.FE.DEFAULTS,{codeMirror:window.CodeMirror,codeMirrorOptions:{lineNumbers:!0,tabMode:"indent",indentWithTabs:!0,lineWrapping:!0,mode:"text/html",tabSize:2},codeBeautifierOptions:{end_with_newline:!0,indent_inner_html:!0,extra_liners:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","ol","table","dl"],brace_style:"expand",indent_char:"\t",indent_size:1,wrap_line_length:0},codeViewKeepActiveButtons:["fullscreen"]}),e.FE.PLUGINS.codeView=function(t){function n(){return t.$box.hasClass("fr-code-view")}function i(){return h?h.getValue():d.val()}function s(){n()&&(h&&h.setSize(null,t.opts.height?t.opts.height:"auto"),t.opts.heightMin||t.opts.height?t.$box.find(".CodeMirror-scroll, .CodeMirror-gutters").css("min-height",t.opts.heightMin||t.opts.height):t.$box.find(".CodeMirror-scroll, .CodeMirror-gutters").css("min-height",""))}function o(){n()&&t.events.trigger("blur")}function r(){n()&&f&&t.events.trigger("focus")}function a(a){d||(function(){d=e('<textarea class="fr-code" tabIndex="-1">'),t.$wp.append(d),d.attr("dir",t.opts.direction),t.$box.hasClass("fr-basic")||(u=e('<a data-cmd="html" title="Code View" class="fr-command fr-btn html-switch'+(t.helpers.isMobile()?"":" fr-desktop")+'" role="button" tabIndex="-1"><i class="fa fa-code"></i></button>'),t.$box.append(u),t.events.bindClick(t.$box,"a.html-switch",function(){t.events.trigger("commands.before",["html"]),l(!1),t.events.trigger("commands.after",["html"])}));var o=function(){return!n()};t.events.on("buttons.refresh",o),t.events.on("copy",o,!0),t.events.on("cut",o,!0),t.events.on("paste",o,!0),t.events.on("destroy",c,!0),t.events.on("html.set",function(){n()&&l(!0)}),t.events.on("codeView.update",s),t.events.on("form.submit",function(){n()&&(t.html.set(i()),t.events.trigger("contentChanged",[],!0))},!0)}(),!h&&t.opts.codeMirror?((h=t.opts.codeMirror.fromTextArea(d.get(0),t.opts.codeMirrorOptions)).on("blur",o),h.on("focus",r)):(t.events.$on(d,"keydown keyup change input",function(){t.opts.height?this.removeAttribute("rows"):(this.rows=1,0===this.value.length?this.style.height="auto":this.style.height=this.scrollHeight+"px")}),t.events.$on(d,"blur",o),t.events.$on(d,"focus",r))),t.undo.saveStep(),t.html.cleanEmptyTags(),t.html.cleanWhiteTags(!0),t.core.hasFocus()&&(t.core.isEmpty()||(t.selection.save(),t.$el.find('.fr-marker[data-type="true"]:first').replaceWith('<span class="fr-tmp fr-sm">F</span>'),t.$el.find('.fr-marker[data-type="false"]:last').replaceWith('<span class="fr-tmp fr-em">F</span>')));var p=t.html.get(!1,!0);t.$el.find("span.fr-tmp").remove(),t.$box.toggleClass("fr-code-view",!0);var g,m,b=!1;if(t.core.hasFocus()&&(b=!0,t.events.disableBlur(),t.$el.blur()),p=(p=p.replace(/<span class="fr-tmp fr-sm">F<\/span>/,"FROALA-SM")).replace(/<span class="fr-tmp fr-em">F<\/span>/,"FROALA-EM"),t.codeBeautifier&&(p=t.codeBeautifier.run(p,t.opts.codeBeautifierOptions)),h){g=p.indexOf("FROALA-SM"),(m=p.indexOf("FROALA-EM"))<g?g=m:m-=9;var v=(p=p.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"")).substring(0,g).length-p.substring(0,g).replace(/\n/g,"").length,M=p.substring(0,m).length-p.substring(0,m).replace(/\n/g,"").length;g=p.substring(0,g).length-p.substring(0,p.substring(0,g).lastIndexOf("\n")+1).length,m=p.substring(0,m).length-p.substring(0,p.substring(0,m).lastIndexOf("\n")+1).length,h.setSize(null,t.opts.height?t.opts.height:"auto"),t.opts.heightMin&&t.$box.find(".CodeMirror-scroll").css("min-height",t.opts.heightMin),h.setValue(p),f=!b,h.focus(),f=!0,h.setSelection({line:v,ch:g},{line:M,ch:m}),h.refresh(),h.clearHistory()}else{g=p.indexOf("FROALA-SM"),m=p.indexOf("FROALA-EM")-9,t.opts.heightMin&&d.css("min-height",t.opts.heightMin),t.opts.height&&d.css("height",t.opts.height),t.opts.heightMax&&d.css("max-height",t.opts.height||t.opts.heightMax),d.val(p.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"")).trigger("change");var x=e(t.o_doc).scrollTop();f=!b,d.focus(),f=!0,d.get(0).setSelectionRange(g,m),e(t.o_doc).scrollTop(x)}t.$tb.find(" > .fr-command").not(a).filter(function(){return t.opts.codeViewKeepActiveButtons.indexOf(e(this).data("cmd"))<0}).addClass("fr-disabled").attr("aria-disabled",!0),a.addClass("fr-active").attr("aria-pressed",!0),!t.helpers.isMobile()&&t.opts.toolbarInline&&t.toolbar.hide()}function l(e){void 0===e&&(e=!n());var s,o,r=t.$tb.find('.fr-command[data-cmd="html"]');e?(t.popups.hideAll(),a(r)):(t.$box.toggleClass("fr-code-view",!1),s=r,o=i(),t.html.set(o),t.$el.blur(),t.$tb.find(" > .fr-command").not(s).removeClass("fr-disabled").attr("aria-disabled",!1),s.removeClass("fr-active").attr("aria-pressed",!1),t.selection.setAtStart(t.el),t.selection.restore(),t.placeholder.refresh(),t.undo.saveStep())}function c(){n()&&l(!1),h&&h.toTextArea(),d.val("").removeData().remove(),d=null,u&&(u.remove(),u=null)}var d,h,u,f=!1;return{_init:function(){if(!t.$wp)return!1},toggle:l,isActive:n,get:i}},e.FE.RegisterCommand("html",{title:"Code View",undo:!1,focus:!1,forcedRefresh:!0,toggle:!0,callback:function(){this.codeView.toggle()},plugin:"codeView"}),e.FE.DefineIcon("html",{NAME:"code"})});